---
sidebar_position: 2
title: Imports de r√®gles
hide_table_of_contents: false
---

Afin de pouvoir r√©utiliser des r√®gles d'un mod√®le √† un autre, il est n√©cessaire
de pouvoir importer des r√®gles d'un autre mod√®le.

Pour ce faire nous avons d√©fini une macro `importer!` qui permet de sp√©cifier
une liste de r√®gles √† importer depuis un fichier JSON d'un [mod√®le
compil√©](./compilation). Par d√©faut, le fichier JSON est recherch√© dans le
package NPM du mod√®le ou bien il est possible de sp√©cifier un chemin vers un
fichier local.

:::info

La macro `importer!` est une macro de compilation et est d√©pendante de
[`getModelFromSource`](compilation#g√©n√©rer-un-mod√®le-json-√†-partir-des-fichiers-sources)
pour fonctionner.

:::

## Importer des r√®gles depuis un mod√®le compil√©

Pour pouvoir utiliser un ensemble de r√®gles d'un autre mod√®le, il faut sp√©cifier
la macro `importer!` au d√©but d'un fichier publicodes.

### Usage

La macro `importer!` poss√®de la syntaxe suivante :

```yaml
importer!:
  depuis:
  	nom: <npm_package_name>
	source: <path_to_the_model_file> (optional)
	url: <url_to_the_package_documentation> (optional)
  dans: <namespace> (optional)
  les r√®gles:
    - <rule_name_from_the_npm_package>
    - <rule_name_from_the_npm_package>:
      <attr_to_overwrite>: <value>
      ...
    ...
```

Avec :

- `depuis` : les informations sur le mod√®le √† importer
  - `nom` : le nom du package NPM du mod√®le √† importer
  - `source` : le chemin vers le fichier JSON du mod√®le √† importer (optionnel)
  - `url` : l'URL vers la documentation du mod√®le √† importer (optionnel)
- `dans` : le namespace dans lequel importer les r√®gles (optionnel)
- `les r√®gles` : la liste des r√®gles √† importer. Il est possible de sp√©cifier
  des attributs √† √©craser pour chaque r√®gle (optionnel)


Par d√©faut, si aucune `source` n'est sp√©cifi√©e, le mod√®le est suppos√© √™tre
[compil√©](./compilation) dans le fichier `<package_name>.model.json` √† la racine
du package NPM. Le package NPM du mod√®le √† utiliser doit donc **√™tre publi√© sur
NPM** et √™tre **ajout√© aux d√©pendances du projet** courant.
Il est √©galement possible de sp√©cifier le chemin vers un fichier local avec
`source`.

Si `dans` n'est pas sp√©cifi√©, les r√®gles seront import√©es dans le namespace
correspondant au nom du package NPM (`nom`).

:::note Fonctionnement

A la compilation, chaque macro `importer!` est remplac√©e par les r√®gles
import√©es **ainsi que leurs d√©pendances**.

:::

#### Exemple

```yaml title="nosgestesclimat/data/logement/piscine.publicodes"
importer!:
  depuis:
    nom: futureco-data
    url: https://github.com/laem/futureco-data
  dans: logement
  les r√®gles:
    - piscine . empreinte eau froide
    - piscine . traitement chimique
    - piscine . construction
    - piscine . surface:
        applicable si: piscine . pr√©sent
        question: Quelle est la taille de votre piscine ?
        description: |
          üí° Pensez √† prendre en compte **les consommations d'√©nergie de la piscine dans celles de votre logement**. Votre facture devrait d'ailleurs √™tre fortement impact√©e si votre piscine est chauff√©e !
        unit√©: m2
        suggestions:
          3 x 5 m√®tres: 15
          5 x 5 m√®tres: 20
          5 x 8 m√®tres: 40
```

## Liste des mod√®les publi√©s

- [`futureco-data`](https://github.com/laem/futureco-data)
  - _mod√®le de [futur.eco](https://futur.eco)._
- [`@incubateur-ademe/nosgestesclimat`](https://github.com/incubateur-ademe/nosgestesclimat)
  - _mod√®le de [Nos Gestes Climat](https://nosgestesclimat.fr)._
- [`@incubateur-ademe/publicodes-impact-livraison`](https://github.com/incubateur-ademe/publicodes-impact-livraison)
  - _mod√®le du simulateur Impact Livraison de [Impact
    CO2](https://impactco2.fr)._
- [`@incubateur-ademe/publicodes-negaoctet`](https://github.com/incubateur-ademe/publicodes-negaoctet)
  - _mod√®le publicodes de la base de donn√©es de
    [NegaOctet](https://negaoctet.org/en/home/#Donnees) utilis√© par [Impact
    CO2](https://impactco2.fr)._
- [`@incubateur-ademe/publicodes-commun`](https://github.com/incubateur-ademe/publicodes-commun)
  - _ensemble de r√®gles communes utilis√©es pour l'impl√©mentation des mod√®les
    publicodes de l'incubateur de l'ADEME._
